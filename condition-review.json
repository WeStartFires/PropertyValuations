{
  "name": "response_schema",
  "strict": true,
  "schema": {
    "type": "object",
    "additionalProperties": false,
    "required": [
      "address",
      "report_date",
      "clearance_needed",
      "internal_summary",
      "external_summary",
      "condition_flags_internal",
      "condition_flags_external",
      "mortgageability_flags",
      "required_before_sale",
      "challenges_flags",
      "challenges_text",
      "advantages_flags",
      "advantages_text",
      "sources"
    ],
    "properties": {
      "address": { "type": "string", "minLength": 1, "maxLength": 300 },
      "report_date": { "type": ["string","null"], "pattern": "^\\d{4}-\\d{2}-\\d{2}$" },
      "clearance_needed": { "type": "boolean" },

      "internal_summary": { "type": "string", "maxLength": 600 },
      "external_summary": { "type": "string", "maxLength": 600 },

      "condition_flags_internal": {
        "type": "array",
        "uniqueItems": true,
        "items": {
          "type": "string",
          "enum": [
            "needs_redecoration",
            "needs_updating",
            "dated_kitchen_bathroom",
            "damp_or_mould",
            "electrics_dated_or_unknown",
            "needs_rewiring",
            "no_central_heating",
            "heating_inoperative",
            "leaks_or_staining",
            "plumbing_issues",
            "uneven_floors_or_cracking",
            "structural_survey_advised",
            "single_glazed",
            "not_fully_double_glazed",
            "storage_heaters",
            "deep_clean_required",
            "bathroom_or_kitchen_replacement",
            "mid_renovation_uncertain",
            "not_habitable"
          ]
        },
        "default": []
      },

      "condition_flags_external": {
        "type": "array",
        "uniqueItems": true,
        "items": {
          "type": "string",
          "enum": [
            "roof_issues",
            "guttering_issues",
            "cracking_render",
            "missing_or_damaged_tiles",
            "overgrown_garden",
            "damaged_fencing_or_boundaries",
            "limited_parking",
            "no_garden",
            "non_standard_construction",
            "mundic_risk"
          ]
        },
        "default": []
      },

      "mortgageability_flags": {
        "type": "array",
        "uniqueItems": true,
        "items": {
          "type": "string",
          "enum": [
            "severe_structural_defects",
            "extensive_damp_or_mould",
            "asbestos_poor_condition",
            "spray_foam_insulation",
            "non_standard_construction",
            "very_short_lease",
            "short_lease",
            "bsa_cladding_risk",
            "high_flood_risk",
            "contaminated_land",
            "cash_buyers_only",
            "age_restriction_55_plus",
            "age_restriction_60_plus",
            "shared_ownership"
          ]
        },
        "default": []
      },

      "required_before_sale": {
        "type": "array",
        "items": { "type": "string", "maxLength": 140 },
        "default": []
      },

      "challenges_flags": {
        "type": "array",
        "uniqueItems": true,
        "items": {
          "type": "string",
          "enum": [
            "market_cooling",
            "low_buyer_demand",
            "high_competition",
            "on_busy_road",
            "near_railway",
            "near_airport",
            "noise_pollution",
            "near_retail_or_pub",
            "opposite_cemetery",
            "limited_parking",
            "small_garden",
            "no_garden",
            "short_lease",
            "very_short_lease",
            "lease_extension_needed",
            "high_service_charge",
            "high_ground_rent",
            "shared_ownership",
            "title_restriction",
            "right_of_way",
            "unregistered_title",
            "conservation_area",
            "listed_building",
            "age_restriction_55_plus",
            "age_restriction_60_plus",
            "ex_local_authority",
            "financial_charges_on_title",
            "pending_title_application",
            "spray_foam_insulation_unmortgageable",
            "mundic_risk",
            "non_standard_construction",
            "bsa_cladding_risk",
            "top_floor_may_deter",
            "storage_heaters",
            "single_glazed",
            "not_fully_double_glazed",
            "needs_redecoration",
            "needs_updating",
            "dated_kitchen_bathroom",
            "damp_or_mould",
            "electrics_dated_or_unknown",
            "needs_rewiring",
            "no_central_heating",
            "heating_inoperative",
            "leaks_or_staining",
            "roof_issues",
            "uneven_floors_or_cracking",
            "structural_survey_advised",
            "bathroom_or_kitchen_replacement",
            "deep_clean_required",
            "plumbing_issues",
            "overgrown_garden",
            "clearance_required",
            "tenanted_complicates_sale",
            "cash_buyers_only",
            "auction_candidate",
            "complex_legal_dispute",
            "mid_renovation_uncertain",
            "limited_comparables"
          ]
        },
        "default": []
      },

      "challenges_text": { "type": "string", "maxLength": 450 },

      "advantages_flags": {
        "type": "array",
        "uniqueItems": true,
        "items": {
          "type": "string",
          "enum": [
            "good_sized_garden","large_bedrooms","walk_to_shops","walk_to_parks","walk_to_station",
            "close_to_good_schools","strong_local_amenities","easy_access
